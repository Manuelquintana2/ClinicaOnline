<div class="solicitar-turno-container">
  <h2>Solicitar Turno</h2>

  <!-- Si es admin, selecciona paciente -->
  <div *ngIf="perfil === 'admin'" class="form-group">
    <label for="paciente">Paciente</label>
    <select id="paciente" [(ngModel)]="turno.uid_paciente">
      <option value="" disabled selected>Seleccione un paciente</option>
      <option *ngFor="let p of pacientes" [value]="p.uid">{{ p.nombre }} {{ p.apellido }}</option>
    </select>
  </div>

  
  <!-- Selección de especialidad -->
  <div class="form-group">
    <label for="especialidad">Especialidad</label>
    <select id="especialidad" [(ngModel)]="turno.especialidad" (change)="onEspecialidadSeleccionada(turno.especialidad)">
      <option value="" disabled selected>Seleccione una especialidad</option>
      <option *ngFor="let e of especialidades" [value]="e">{{ e }}</option>
    </select>
  </div>
  <!-- Selección de especialista -->
  <div class="form-group" *ngIf="turno.especialidad">
      <label for="especialista">Especialista</label>
      <select id="especialista" [(ngModel)]="turno.uid_especialista" (change)="onEspecialistaSeleccionado()">
          <option value="" disabled selected>Seleccione un especialista</option>
          <ng-container *ngFor="let esp of especialistas">
              <option *ngIf="esp.especialidades?.includes(turno.especialidad)" [value]="esp.uid">
                  {{ esp.nombre }} {{ esp.apellido }}
                </option>
            </ng-container>
        </select>
    </div>
    
  <!-- Selección de fecha (lista de próximos 15 días disponibles) -->
  <div class="form-group" *ngIf="fechasDisponibles.length > 0">
    <label>Fecha</label>
    <div class="fechas-lista">
      <button 
        *ngFor="let fecha of fechasDisponibles" 
        type="button"
        (click)="seleccionarFecha(fecha)" 
        [class.selected]="turno.fecha === fecha">
        {{ fecha }}
      </button>
    </div>
  </div>

  <!-- Selección de horario -->
  <div class="form-group" *ngIf="horariosDisponibles.length > 0">
    <label>Horario</label>
    <div class="horarios-lista">
      <button 
        *ngFor="let hora of horariosDisponibles" 
        type="button"
        (click)="seleccionarHora(hora)" 
        [class.selected]="turno.hora_inicio === hora">
        {{ hora }}
      </button>
    </div>
  </div>

  <!-- Botón para crear turno -->
  <div class="form-group">
    <button (click)="crearTurno()" [disabled]="!turno.fecha || !turno.hora_inicio || !turno.uid_especialista || !turno.especialidad || (perfil === 'admin' && !turno.uid_paciente)">
      Solicitar Turno
    </button>
  </div>
</div>

